\doxysection{map\+\_\+builder.\+py}
\hypertarget{map__builder_8py_source}{}\label{map__builder_8py_source}\index{sim\_app/map\_builder.py@{sim\_app/map\_builder.py}}
\mbox{\hyperlink{map__builder_8py}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{map__builder_8py_source_l00001}\mbox{\hyperlink{namespacemap__builder}{00001}}\ \textcolor{keyword}{import}\ numpy\ \textcolor{keyword}{as}\ np}
\DoxyCodeLine{\Hypertarget{map__builder_8py_source_l00002}00002\ \textcolor{keyword}{from}\ sim\_app.shared\ \textcolor{keyword}{import}\ latest\_data}
\DoxyCodeLine{\Hypertarget{map__builder_8py_source_l00003}00003\ }
\DoxyCodeLine{\Hypertarget{map__builder_8py_source_l00004}00004\ \textcolor{comment}{\#\ Map\ dimensions\ in\ meters}}
\DoxyCodeLine{\Hypertarget{map__builder_8py_source_l00005}\mbox{\hyperlink{namespacemap__builder_a60752dd66922423dde3743ff04467f4f}{00005}}\ MAP\_WIDTH\ =\ 40.0}
\DoxyCodeLine{\Hypertarget{map__builder_8py_source_l00006}\mbox{\hyperlink{namespacemap__builder_a927d0695a5ba6e9fcd7a6950d9e78a23}{00006}}\ MAP\_HEIGHT\ =\ 40.0}
\DoxyCodeLine{\Hypertarget{map__builder_8py_source_l00007}00007\ }
\DoxyCodeLine{\Hypertarget{map__builder_8py_source_l00008}\mbox{\hyperlink{namespacemap__builder_a0eabac541063a12a54a09cb26f439fc4}{00008}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacemap__builder_a0eabac541063a12a54a09cb26f439fc4}{update\_grid\_with\_sensors}}(grid,\ resolution,\ robot\_name):}
\DoxyCodeLine{\Hypertarget{map__builder_8py_source_l00009}00009\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{map__builder_8py_source_l00010}00010\ \textcolor{stringliteral}{\ \ \ \ Updates\ the\ occupancy\ grid\ with\ sensor\ data\ for\ a\ specified\ robot.}}
\DoxyCodeLine{\Hypertarget{map__builder_8py_source_l00011}00011\ \textcolor{stringliteral}{\ \ \ \ This\ function\ iterates\ over\ specific\ sensor\ signals\ associated\ with\ the\ given\ robot\ name,}}
\DoxyCodeLine{\Hypertarget{map__builder_8py_source_l00012}00012\ \textcolor{stringliteral}{\ \ \ \ retrieves\ the\ latest\ sensor\ data\ points,\ and\ marks\ the\ corresponding\ grid\ cells\ as\ occupied.}}
\DoxyCodeLine{\Hypertarget{map__builder_8py_source_l00013}00013\ \textcolor{stringliteral}{\ \ \ \ Args:}}
\DoxyCodeLine{\Hypertarget{map__builder_8py_source_l00014}00014\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ grid\ (np.ndarray):\ 2D\ numpy\ array\ representing\ the\ occupancy\ grid.}}
\DoxyCodeLine{\Hypertarget{map__builder_8py_source_l00015}00015\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ resolution\ (float):\ The\ resolution\ of\ the\ grid\ (meters\ per\ cell).}}
\DoxyCodeLine{\Hypertarget{map__builder_8py_source_l00016}00016\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ robot\_name\ (str):\ The\ name\ of\ the\ robot\ whose\ sensor\ data\ is\ used.}}
\DoxyCodeLine{\Hypertarget{map__builder_8py_source_l00017}00017\ \textcolor{stringliteral}{\ \ \ \ Notes:}}
\DoxyCodeLine{\Hypertarget{map__builder_8py_source_l00018}00018\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/\ The\ function\ expects\ a\ global\ variable\ \`{}latest\_data\`{}\ containing\ sensor\ readings.}}
\DoxyCodeLine{\Hypertarget{map__builder_8py_source_l00019}00019\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/\ The\ grid\ is\ updated\ in-\/place,\ with\ occupied\ cells\ set\ to\ 1.}}
\DoxyCodeLine{\Hypertarget{map__builder_8py_source_l00020}00020\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ -\/\ The\ function\ assumes\ the\ existence\ of\ global\ constants\ \`{}MAP\_WIDTH\`{}\ and\ \`{}MAP\_HEIGHT\`{}.}}
\DoxyCodeLine{\Hypertarget{map__builder_8py_source_l00021}00021\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{map__builder_8py_source_l00022}00022\ }
\DoxyCodeLine{\Hypertarget{map__builder_8py_source_l00023}00023\ \ \ \ \ \textcolor{keywordflow}{for}\ signal\ \textcolor{keywordflow}{in}\ [f\textcolor{stringliteral}{"{}\{robot\_name\}\_S300\_sensor1"{}},\ f\textcolor{stringliteral}{"{}\{robot\_name\}\_S300\_sensor2"{}},\ f\textcolor{stringliteral}{"{}\{robot\_name\}\_S3001\_sensor1"{}},\ f\textcolor{stringliteral}{"{}\{robot\_name\}\_S3001\_sensor2"{}}]:}
\DoxyCodeLine{\Hypertarget{map__builder_8py_source_l00024}00024\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ pt\ \textcolor{keywordflow}{in}\ latest\_data.get(signal,\ []):}
\DoxyCodeLine{\Hypertarget{map__builder_8py_source_l00025}00025\ \ \ \ \ \ \ \ \ \ \ \ \ x,\ y,\ \_,\ dist\ =\ pt}
\DoxyCodeLine{\Hypertarget{map__builder_8py_source_l00026}00026\ \ \ \ \ \ \ \ \ \ \ \ \ gx\ =\ int((x\ +\ MAP\_WIDTH\ /\ 2)\ /\ resolution)}
\DoxyCodeLine{\Hypertarget{map__builder_8py_source_l00027}00027\ \ \ \ \ \ \ \ \ \ \ \ \ gy\ =\ int((y\ +\ MAP\_HEIGHT\ /\ 2)\ /\ resolution)}
\DoxyCodeLine{\Hypertarget{map__builder_8py_source_l00028}00028\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ 0\ <=\ gx\ <\ grid.shape[1]\ \textcolor{keywordflow}{and}\ 0\ <=\ gy\ <\ grid.shape[0]:}
\DoxyCodeLine{\Hypertarget{map__builder_8py_source_l00029}00029\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ grid[gy][gx]\ =\ 1\ \ \textcolor{comment}{\#\ flip\ gy/gx:\ rows\ =\ Y,\ cols\ =\ X}}
\DoxyCodeLine{\Hypertarget{map__builder_8py_source_l00030}00030\ }
\DoxyCodeLine{\Hypertarget{map__builder_8py_source_l00031}\mbox{\hyperlink{namespacemap__builder_a2aada3bbc73d47b39eabff5c0fb37d80}{00031}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespacemap__builder_a2aada3bbc73d47b39eabff5c0fb37d80}{build\_occupancy\_grid}}(robot\_name,\ grid\_size=200,\ cell\_resolution=0.2):}
\DoxyCodeLine{\Hypertarget{map__builder_8py_source_l00032}00032\ \ \ \ \ grid\ =\ np.zeros((grid\_size,\ grid\_size),\ dtype=np.uint8)}
\DoxyCodeLine{\Hypertarget{map__builder_8py_source_l00033}00033\ }
\DoxyCodeLine{\Hypertarget{map__builder_8py_source_l00034}00034\ \ \ \ \ \mbox{\hyperlink{namespacemap__builder_a0eabac541063a12a54a09cb26f439fc4}{update\_grid\_with\_sensors}}(grid,\ cell\_resolution,\ robot\_name)}
\DoxyCodeLine{\Hypertarget{map__builder_8py_source_l00035}00035\ }
\DoxyCodeLine{\Hypertarget{map__builder_8py_source_l00036}00036\ \ \ \ \ \textcolor{keywordflow}{return}\ grid}

\end{DoxyCode}
